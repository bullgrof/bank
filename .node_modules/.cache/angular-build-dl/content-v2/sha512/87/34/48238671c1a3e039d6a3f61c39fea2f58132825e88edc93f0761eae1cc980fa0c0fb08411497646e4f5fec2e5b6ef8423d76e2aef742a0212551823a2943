function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["pages-register-user-register-user-module"], {
  /***/
  "./node_modules/raw-loader/dist/cjs.js!./src/app/pages/register-user/register-user.page.html":
  /*!***************************************************************************************************!*\
    !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/pages/register-user/register-user.page.html ***!
    \***************************************************************************************************/

  /*! exports provided: default */

  /***/
  function node_modulesRawLoaderDistCjsJsSrcAppPagesRegisterUserRegisterUserPageHtml(module, __webpack_exports__, __webpack_require__) {
    "use strict";

    __webpack_require__.r(__webpack_exports__);
    /* harmony default export */


    __webpack_exports__["default"] = "<ion-header>\r\n  <ion-toolbar color=\"warning\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-back-button defaultHref=\"/login\" icon-only></ion-back-button>\r\n      Registro\r\n    </ion-buttons>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content>\r\n  <ion-card class=\"card-middle\">\r\n    <ion-card-content>\r\n\r\n      <img src=\"../../../assets/usersekret.svg\"  height=\"100px\" alt=\"\">\r\n      \r\n      <form  (ngSubmit)=\"registerUser()\" #formuser=\"ngForm\" >\r\n        <ion-list>\r\n            <ion-row>\r\n                <ion-col size=\"8\">\r\n                    <ion-item>\r\n                        <ion-label position=\"floating\" required=\"true\">Token</ion-label>\r\n                        <ion-input type=\"text\"\r\n                                    name=\"idtoken\"\r\n                                   [(ngModel)]=\"users.idtoken\" \r\n                                   [value]=\"users.idtoken\"\r\n                                   required\r\n                                   max=\"20\"\r\n                                   (change)=\"verifyt(users.idtoken)\">\r\n                        </ion-input>           \r\n                    </ion-item>\r\n                </ion-col>\r\n              \r\n                <ion-col size=\"4\">\r\n                  <ion-tab-button (click)=\"scan()\" >\r\n                    <ion-icon name=\"barcode\"></ion-icon>\r\n                    <ion-label>Escanear</ion-label>\r\n                  </ion-tab-button>\r\n                </ion-col>\r\n            </ion-row>\r\n           \r\n            <ion-item>\r\n              <ion-label position=\"floating\" required=\"true\">Usuario</ion-label>\r\n              <ion-input type=\"text\"\r\n                          name=\"username\"\r\n                         [(ngModel)]=\"users.username\" \r\n                         (change)=\"verifyu(users.username)\"\r\n                         required>\r\n              </ion-input>           \r\n            </ion-item>\r\n\r\n            <ion-item>\r\n                <ion-label position=\"floating\" required=\"true\">Contraseña</ion-label>\r\n                <ion-input type=\"password\"\r\n                            name=\"password\"\r\n                           [(ngModel)]=\"users.password\" \r\n                           required\r\n                           #input>\r\n                </ion-input>\r\n            </ion-item>\r\n\r\n            <ion-item>\r\n                <ion-label position=\"floating\" required=\"true\">Repetir Contraseña</ion-label>\r\n                <ion-input type=\"password\"\r\n                            name=\"passwordv\"\r\n                           [(ngModel)]=\"users.passwordv\" \r\n                           required\r\n                           #input2\r\n                           (change)=\"passwordsmatch(users.password, users.passwordv)\">\r\n                </ion-input>               \r\n                \r\n            </ion-item>\r\n            <ion-item>\r\n                <label class=\"{{classpassinput}}\">{{passwordsnotmatch}}</label>\r\n            </ion-item>       \r\n            \r\n            <ion-item>\r\n              <ion-checkbox color=\"warning\"></ion-checkbox>\r\n              <label for=\"\"> &nbsp;Acepto los términos y condiciones.</label>\r\n            </ion-item>\r\n\r\n        \r\n        <ion-button expand=\"block\" \r\n        fill=\"outline\" \r\n                    type=\"submit\" \r\n                    [disabled]=\"formuser.invalid\"\r\n                    \r\n                    color=\"warning\">\r\n              <ion-icon name=\"log-in\" class=\"marginicon\"></ion-icon>   Registrarme\r\n        </ion-button>\r\n      </ion-list>\r\n\r\n      </form>\r\n             \r\n      \r\n    </ion-card-content>\r\n  </ion-card>\r\n</ion-content>\r\n";
    /***/
  },

  /***/
  "./src/app/pages/register-user/register-user.module.ts":
  /*!*************************************************************!*\
    !*** ./src/app/pages/register-user/register-user.module.ts ***!
    \*************************************************************/

  /*! exports provided: RegisterUserPageModule */

  /***/
  function srcAppPagesRegisterUserRegisterUserModuleTs(module, __webpack_exports__, __webpack_require__) {
    "use strict";

    __webpack_require__.r(__webpack_exports__);
    /* harmony export (binding) */


    __webpack_require__.d(__webpack_exports__, "RegisterUserPageModule", function () {
      return RegisterUserPageModule;
    });
    /* harmony import */


    var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(
    /*! tslib */
    "./node_modules/tslib/tslib.es6.js");
    /* harmony import */


    var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(
    /*! @angular/core */
    "./node_modules/@angular/core/fesm2015/core.js");
    /* harmony import */


    var _angular_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(
    /*! @angular/common */
    "./node_modules/@angular/common/fesm2015/common.js");
    /* harmony import */


    var _angular_forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(
    /*! @angular/forms */
    "./node_modules/@angular/forms/fesm2015/forms.js");
    /* harmony import */


    var _angular_router__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(
    /*! @angular/router */
    "./node_modules/@angular/router/fesm2015/router.js");
    /* harmony import */


    var _ionic_angular__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(
    /*! @ionic/angular */
    "./node_modules/@ionic/angular/dist/fesm5.js");
    /* harmony import */


    var _register_user_page__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(
    /*! ./register-user.page */
    "./src/app/pages/register-user/register-user.page.ts");

    var routes = [{
      path: '',
      component: _register_user_page__WEBPACK_IMPORTED_MODULE_6__["RegisterUserPage"]
    }];

    var RegisterUserPageModule = function RegisterUserPageModule() {
      _classCallCheck(this, RegisterUserPageModule);
    };

    RegisterUserPageModule = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["NgModule"])({
      imports: [_angular_common__WEBPACK_IMPORTED_MODULE_2__["CommonModule"], _angular_forms__WEBPACK_IMPORTED_MODULE_3__["FormsModule"], _ionic_angular__WEBPACK_IMPORTED_MODULE_5__["IonicModule"], _angular_router__WEBPACK_IMPORTED_MODULE_4__["RouterModule"].forChild(routes)],
      declarations: [_register_user_page__WEBPACK_IMPORTED_MODULE_6__["RegisterUserPage"]]
    })], RegisterUserPageModule);
    /***/
  },

  /***/
  "./src/app/pages/register-user/register-user.page.scss":
  /*!*************************************************************!*\
    !*** ./src/app/pages/register-user/register-user.page.scss ***!
    \*************************************************************/

  /*! exports provided: default */

  /***/
  function srcAppPagesRegisterUserRegisterUserPageScss(module, __webpack_exports__, __webpack_require__) {
    "use strict";

    __webpack_require__.r(__webpack_exports__);
    /* harmony default export */


    __webpack_exports__["default"] = "toolbar-title toolbar-title-ios {\n  font-size: 1.7rem; }\n\ntoolbar-title toolbar-title-md {\n  font-size: 2rem; }\n\ntoolbar-title toolbar-title-wp {\n  font-size: 1.5rem; }\n\n.marginicon {\n  margin-left: 3px; }\n\n.dontmatch {\n  color: red;\n  font-size: x-small;\n  margin-top: 2px; }\n\n.match {\n  color: greenyellow;\n  font-size: x-small;\n  margin-top: 2px; }\n\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvcmVnaXN0ZXItdXNlci9DOlxcVXNlcnNcXE5lbWVzc2lzXFxEZXNrdG9wXFxwdjJcXGZyb250XFxjb3JlXFxmc3Uvc3JjXFxhcHBcXHBhZ2VzXFxyZWdpc3Rlci11c2VyXFxyZWdpc3Rlci11c2VyLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGlCQUFpQixFQUFBOztBQUduQjtFQUNFLGVBQWUsRUFBQTs7QUFHakI7RUFDRSxpQkFBaUIsRUFBQTs7QUFHbkI7RUFDRSxnQkFBZ0IsRUFBQTs7QUFHbEI7RUFDRSxVQUFVO0VBQ1Ysa0JBQWtCO0VBQ2xCLGVBQWUsRUFBQTs7QUFHakI7RUFDRSxrQkFBa0I7RUFDbEIsa0JBQWtCO0VBQ2xCLGVBQWUsRUFBQSIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL3JlZ2lzdGVyLXVzZXIvcmVnaXN0ZXItdXNlci5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJ0b29sYmFyLXRpdGxlIHRvb2xiYXItdGl0bGUtaW9zIHsgXHJcbiAgICBmb250LXNpemU6IDEuN3JlbTtcclxuICB9XHJcblxyXG4gIHRvb2xiYXItdGl0bGUgdG9vbGJhci10aXRsZS1tZCB7IFxyXG4gICAgZm9udC1zaXplOiAycmVtO1xyXG4gIH1cclxuXHJcbiAgdG9vbGJhci10aXRsZSB0b29sYmFyLXRpdGxlLXdwIHsgXHJcbiAgICBmb250LXNpemU6IDEuNXJlbTtcclxuICB9XHJcblxyXG4gIC5tYXJnaW5pY29ue1xyXG4gICAgbWFyZ2luLWxlZnQ6IDNweDtcclxuICB9XHJcblxyXG4gIC5kb250bWF0Y2h7XHJcbiAgICBjb2xvcjogcmVkO1xyXG4gICAgZm9udC1zaXplOiB4LXNtYWxsO1xyXG4gICAgbWFyZ2luLXRvcDogMnB4O1xyXG4gIH1cclxuXHJcbiAgLm1hdGNoe1xyXG4gICAgY29sb3I6IGdyZWVueWVsbG93O1xyXG4gICAgZm9udC1zaXplOiB4LXNtYWxsO1xyXG4gICAgbWFyZ2luLXRvcDogMnB4O1xyXG59Il19 */";
    /***/
  },

  /***/
  "./src/app/pages/register-user/register-user.page.ts":
  /*!***********************************************************!*\
    !*** ./src/app/pages/register-user/register-user.page.ts ***!
    \***********************************************************/

  /*! exports provided: RegisterUserPage */

  /***/
  function srcAppPagesRegisterUserRegisterUserPageTs(module, __webpack_exports__, __webpack_require__) {
    "use strict";

    __webpack_require__.r(__webpack_exports__);
    /* harmony export (binding) */


    __webpack_require__.d(__webpack_exports__, "RegisterUserPage", function () {
      return RegisterUserPage;
    });
    /* harmony import */


    var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(
    /*! tslib */
    "./node_modules/tslib/tslib.es6.js");
    /* harmony import */


    var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(
    /*! @angular/core */
    "./node_modules/@angular/core/fesm2015/core.js");
    /* harmony import */


    var _ionic_native_barcode_scanner_ngx__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(
    /*! @ionic-native/barcode-scanner/ngx */
    "./node_modules/@ionic-native/barcode-scanner/ngx/index.js");
    /* harmony import */


    var _ionic_angular__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(
    /*! @ionic/angular */
    "./node_modules/@ionic/angular/dist/fesm5.js");
    /* harmony import */


    var _services_tokens_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(
    /*! ../../services/tokens.service */
    "./src/app/services/tokens.service.ts");
    /* harmony import */


    var _services_users_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(
    /*! ../../services/users.service */
    "./src/app/services/users.service.ts");
    /* harmony import */


    var _angular_router__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(
    /*! @angular/router */
    "./node_modules/@angular/router/fesm2015/router.js");
    /* harmony import */


    var _angular_common__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(
    /*! @angular/common */
    "./node_modules/@angular/common/fesm2015/common.js");
    /* harmony import */


    var src_app_services_push_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(
    /*! src/app/services/push.service */
    "./src/app/services/push.service.ts");
    /*
    verifyt(): metodo que verifica los tockens al ingresarlo qeu si estan disponible
    */
    //import { Format } from 'date-format';


    var RegisterUserPage = /*#__PURE__*/function () {
      function RegisterUserPage(barcodeScanner, tokenService, toastCtrl, userService, router, datePipe, menuCtrl, pushService) {
        _classCallCheck(this, RegisterUserPage);

        this.barcodeScanner = barcodeScanner;
        this.tokenService = tokenService;
        this.toastCtrl = toastCtrl;
        this.userService = userService;
        this.router = router;
        this.datePipe = datePipe;
        this.menuCtrl = menuCtrl;
        this.pushService = pushService;
        this.passwordsnotmatch = '';
        this.defaulvalue = 0;
        this.idtoken = 4;
        this.users = {
          username: '',
          password: '',
          secondpass: '',
          expire_in: '',
          notificationId: ''
        };
        this.userRegister = {
          username: '',
          password: '',
          idtoken: ''
        };
        this.userRegisterValid = {
          username: 0,
          password: 0,
          idtoken: 0
        };
        this.respuesta = '';
        this.veryfytoken = '';
      }

      _createClass(RegisterUserPage, [{
        key: "ngOnInit",
        value: function ngOnInit() {}
      }, {
        key: "ionViewWillEnter",
        value: function ionViewWillEnter() {
          this.menuCtrl.enable(false);
        }
      }, {
        key: "registerUser",
        value: function registerUser(formuser) {
          return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
            var tokenResponse, newDateExpire, array_date, year, month, day, newFormatDate, newDate, valid;
            return regeneratorRuntime.wrap(function _callee$(_context) {
              while (1) {
                switch (_context.prev = _context.next) {
                  case 0:
                    // if ( formuser.invalid ){ return; }
                    tokenResponse = this.verifyt(this.users.idtoken);
                    console.log('******', this.userRegisterValid.idtoken);
                    this.timTokenVar = this.getDays(tokenResponse);
                    console.log('ARREGLO DE USUARIO: USUARIO', this.users.username);
                    console.log('ARREGLO DE USUARIO: iDTOKEN', this.users.idtoken);
                    console.log('ARREGLO DE USUARIO: PASSWORD', this.users.password);
                    console.log('ARREGLO DE USUARIO: EXPIREIN ', this.users.expire_in);
                    newDateExpire = this.timTokenVar;
                    array_date = newDateExpire.split("/"); //esta linea esta bien y te genera el arreglo

                    year = parseInt(array_date[2]);
                    month = parseInt(array_date[1]);
                    day = parseInt(array_date[0]);
                    newFormatDate = year + '-' + month + '-' + day;
                    newDate = this.datePipe.transform(newFormatDate, "yyyy-MM-dd, h:mm a");
                    console.log('YYYYYYYYYYYYYYYY', newDate); //console.log('ARREGLO DE USUARIO', newFormatDate);

                    this.users = {
                      username: this.users.username,
                      password: this.users.password,
                      secondpass: '',
                      expire_in: newDate,
                      notificationId: this.pushService.getuserIdOneSignal()
                    };
                    console.log('++++++++++++++', this.users);
                    _context.next = 19;
                    return this.userService.registrarUsuario(this.users);

                  case 19:
                    valid = _context.sent;
                    this.presentToast('Usuario registrado');
                    this.users.username = '';
                    this.users.password = '';
                    this.users.token = '';
                    this.users.passwordv = ''; //console.log('validacion de usuario : ', valid); 

                  case 25:
                  case "end":
                    return _context.stop();
                }
              }
            }, _callee, this);
          }));
        }
      }, {
        key: "presentToast",
        value: function presentToast(message) {
          return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
            var toast;
            return regeneratorRuntime.wrap(function _callee2$(_context2) {
              while (1) {
                switch (_context2.prev = _context2.next) {
                  case 0:
                    _context2.next = 2;
                    return this.toastCtrl.create({
                      message: message,
                      duration: 2000,
                      position: 'top'
                    });

                  case 2:
                    toast = _context2.sent;
                    toast.present();

                  case 4:
                  case "end":
                    return _context2.stop();
                }
              }
            }, _callee2, this);
          }));
        }
      }, {
        key: "verifyt",
        value: function verifyt(token) {
          var _this = this;

          //console.log('Ingresa por revision: ', token);
          var characters = token.length;

          if (characters === 20) {
            this.tokenService.getVerifyToken(token).subscribe(function (resp) {
              console.log('resp token', resp);

              if (resp.tokens[0].token != null && resp.tokens[0].state === '1') {
                _this.idplan = resp.tokens[0].idplan;

                _this.presentToast('El tocken se encuentra disponible');

                _this.getDays(_this.idplan);
              } else {
                _this.userRegisterValid.idtoken = 1;

                _this.presentToast('El tocken No esta disponible');

                _this.idplan = 1010;
              }
            });
          } else {
            this.presentToast('El tocken No esta registrado');
            this.userRegisterValid.idtoken = 1;
          }

          return this.idplan;
        }
      }, {
        key: "getDays",
        value: function getDays(idplan) {
          var _this2 = this;

          var idplanToService = idplan; //console.log('IDPLAN TO SEARCH', idplanToService)

          this.tokenService.getRemainingDays(idplan).subscribe(function (resp) {
            console.log('PLAN AL QUE PERTENECE', resp);
            console.log('DIAS DEL PLAN', resp.plans[0].timetoexpire);
            _this2.timeToken = resp.plans[0].timetoexpire;
            var hoy = new Date();
            var devolucion = new Date();
            devolucion.setDate(hoy.getDate() + _this2.timeToken);
            console.log('FECHA ACTUAL', Date());
            _this2.testing = devolucion.toLocaleDateString();
          });
          return this.testing;
        }
      }, {
        key: "onSubmitUserCreate",
        value: function onSubmitUserCreate() {
          console.log("paso");
          console.log(this.users);
        }
      }, {
        key: "scan",
        value: function scan() {
          var _this3 = this;

          this.barcodeScanner.scan().then(function (barcodeData) {
            //console.log('Barcode data', barcodeData);
            _this3.users.idtoken = barcodeData.text;
          })["catch"](function (err) {
            console.log('Error', err);
          });
        }
      }, {
        key: "passwordsmatch",
        value: function passwordsmatch(pass1, pass2) {
          console.log('passoword 1', pass1);
          console.log('passoword 2', pass2);

          if (pass1 === pass2) {
            this.passwordsnotmatch = 'Correcto';
            this.classpassinput = 'match';
            this.userRegisterValid.password = 0;
          } else {
            this.passwordsnotmatch = 'Las contraseñas no coinciden';
            this.classpassinput = 'dontmatch';
            this.userRegisterValid.password = 1;
          }
        }
      }, {
        key: "verifyu",
        value: function verifyu(user) {
          var _this4 = this;

          this.userService.getVerifyUser(user).subscribe(function (response) {
            _this4.verifyUser = response.user[0];
            console.log('+++++++++++', _this4.verifyUser);

            if (!_this4.verifyUser) {
              _this4.presentToast('Usuario disponible');
            } else {
              _this4.presentToast('Usuario no disponible');
            }
          });
        }
      }]);

      return RegisterUserPage;
    }();

    RegisterUserPage.ctorParameters = function () {
      return [{
        type: _ionic_native_barcode_scanner_ngx__WEBPACK_IMPORTED_MODULE_2__["BarcodeScanner"]
      }, {
        type: _services_tokens_service__WEBPACK_IMPORTED_MODULE_4__["TokenService"]
      }, {
        type: _ionic_angular__WEBPACK_IMPORTED_MODULE_3__["ToastController"]
      }, {
        type: _services_users_service__WEBPACK_IMPORTED_MODULE_5__["UsersService"]
      }, {
        type: _angular_router__WEBPACK_IMPORTED_MODULE_6__["Router"]
      }, {
        type: _angular_common__WEBPACK_IMPORTED_MODULE_7__["DatePipe"]
      }, {
        type: _ionic_angular__WEBPACK_IMPORTED_MODULE_3__["MenuController"]
      }, {
        type: src_app_services_push_service__WEBPACK_IMPORTED_MODULE_8__["PushService"]
      }];
    };

    RegisterUserPage = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
      selector: 'app-register-user',
      template: tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(
      /*! raw-loader!./register-user.page.html */
      "./node_modules/raw-loader/dist/cjs.js!./src/app/pages/register-user/register-user.page.html"))["default"],
      styles: [tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(
      /*! ./register-user.page.scss */
      "./src/app/pages/register-user/register-user.page.scss"))["default"]]
    }), tslib__WEBPACK_IMPORTED_MODULE_0__["__metadata"]("design:paramtypes", [_ionic_native_barcode_scanner_ngx__WEBPACK_IMPORTED_MODULE_2__["BarcodeScanner"], _services_tokens_service__WEBPACK_IMPORTED_MODULE_4__["TokenService"], _ionic_angular__WEBPACK_IMPORTED_MODULE_3__["ToastController"], _services_users_service__WEBPACK_IMPORTED_MODULE_5__["UsersService"], _angular_router__WEBPACK_IMPORTED_MODULE_6__["Router"], _angular_common__WEBPACK_IMPORTED_MODULE_7__["DatePipe"], _ionic_angular__WEBPACK_IMPORTED_MODULE_3__["MenuController"], src_app_services_push_service__WEBPACK_IMPORTED_MODULE_8__["PushService"]])], RegisterUserPage);
    /***/
  }
}]);
//# sourceMappingURL=pages-register-user-register-user-module-es5.js.map