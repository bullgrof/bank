{"version":3,"sources":["src/app/pages/requests/requests.page.html","src/app/pages/requests/requests.module.ts","src/app/pages/requests/requests.page.scss","src/app/pages/requests/requests.page.ts"],"names":[],"mappings":"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","sourcesContent":["export default \"<ion-header >\\r\\n  <ion-toolbar color=\\\"warning\\\">\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-back-button defaultHref=\\\"/contacts\\\" text=\\\"\\\"></ion-back-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title>{{'REQUESTS.title' | translate}} ({{numberRequests}})</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <ion-list>\\r\\n    <h3 *ngIf=\\\"requests.length === 0 \\\" class=\\\"text-center\\\">{{'REQUESTS.dontHaveRequests' | translate}}</h3>\\r\\n    <ion-item-sliding *ngFor=\\\"let req of requests\\\">\\r\\n      <ion-item class=\\\"itemheight\\\" *ngIf=\\\"requests.length > 0 \\\">\\r\\n        <ion-avatar slot=\\\"start\\\">\\r\\n          <img src=\\\"../../../assets/avatars/defaultavatar.png\\\">\\r\\n        </ion-avatar>\\r\\n        <ion-label class=\\\"sc-ion-label-ios-h sc-ion-label-ios-s ios hydrated\\\">\\r\\n          <h3>{{ req.siduser }}</h3>\\r\\n        </ion-label>\\r\\n        <p><small>{{req.message}}</small> </p>\\r\\n        <ion-icon slot=\\\"end\\\" name=\\\"chevron-back-outline\\\" class=\\\"backArrow\\\"></ion-icon>\\r\\n        <label slot=\\\"end\\\" class=\\\"swip\\\">{{'REQUESTS.swip' | translate}} </label>\\r\\n      </ion-item>\\r\\n      <ion-item-options side=\\\"end\\\">\\r\\n        <ion-item-option (click)=\\\"acceptRequest(req._id)\\\" color=\\\"success\\\">\\r\\n          <ion-icon name=\\\"checkmark-circle\\\"></ion-icon>{{'REQUESTS.acept' | translate}}\\r\\n        </ion-item-option>\\r\\n        <ion-item-option (click)=\\\"rejectionRequest(req._id)\\\" color=\\\"danger\\\">\\r\\n          <ion-icon name=\\\"trash\\\"></ion-icon>{{'REQUESTS.reject' | translate}}\\r\\n        </ion-item-option>\\r\\n      </ion-item-options>\\r\\n    </ion-item-sliding>\\r\\n  </ion-list>\\r\\n</ion-content>\"","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { RequestsPage } from './requests.page';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: RequestsPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    RouterModule.forChild(routes),\r\n    TranslateModule\r\n  ],\r\n  declarations: [RequestsPage]\r\n})\r\nexport class RequestsPageModule {}\r\n","export default \".text-center {\\n  text-align: center;\\n  margin-top: 50%; }\\n\\n.swip {\\n  color: #424242;\\n  font-size: 12px; }\\n\\n.backArrow {\\n  color: #424242; }\\n\\n.nameUser {\\n  font-weight: bold; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvcmVxdWVzdHMvQzpcXFVzZXJzXFxOZW1lc3Npc1xcRGVza3RvcFxcZGV2XFxBYnJpbFxcZnN1L3NyY1xcYXBwXFxwYWdlc1xccmVxdWVzdHNcXHJlcXVlc3RzLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGtCQUFrQjtFQUNsQixlQUFlLEVBQUE7O0FBR25CO0VBQ0ksY0FBYztFQUNkLGVBQWUsRUFBQTs7QUFHbkI7RUFDSSxjQUFjLEVBQUE7O0FBR2xCO0VBQ0ksaUJBQWlCLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9wYWdlcy9yZXF1ZXN0cy9yZXF1ZXN0cy5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIudGV4dC1jZW50ZXJ7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICBtYXJnaW4tdG9wOiA1MCU7XHJcbn1cclxuXHJcbi5zd2lwe1xyXG4gICAgY29sb3IgOiM0MjQyNDI7XHJcbiAgICBmb250LXNpemU6IDEycHg7XHJcbn1cclxuXHJcbi5iYWNrQXJyb3d7XHJcbiAgICBjb2xvcjogIzQyNDI0MjtcclxufVxyXG5cclxuLm5hbWVVc2Vye1xyXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbn0iXX0= */\"","import { Component, OnInit } from '@angular/core';\r\nimport { ContactsService } from 'src/app/services/contacts.service';\r\nimport { UsersService } from 'src/app/services/users.service';\r\nimport { ThrowStmt } from '@angular/compiler';\r\nimport { ActivatedRoute } from '@angular/router';\r\n\r\nimport { Storage } from '@ionic/storage';\r\nimport { UiServiceService } from 'src/app/services/ui-service.service';\r\nimport { PushService } from 'src/app/services/push.service';\r\n\r\n\r\nimport { QRScanner, QRScannerStatus } from '@ionic-native/qr-scanner/ngx';\r\n\r\n@Component({\r\n  selector: 'app-requests',\r\n  templateUrl: './requests.page.html',\r\n  styleUrls: ['./requests.page.scss'],\r\n})\r\nexport class RequestsPage implements OnInit {\r\n\r\n  constructor(private ContactsService: ContactsService,\r\n              private UsersService: UsersService,\r\n              private activeRoute: ActivatedRoute,\r\n              private storage: Storage,\r\n              private userService: UsersService,\r\n              private uiService: UiServiceService,\r\n              private qrScanner:  QRScanner,\r\n              private pushService : PushService ) { }\r\n\r\n  //vars front\r\n  sidArg = '';\r\n  numberRequests = 0;\r\n  requests : any = [];\r\n  prueba = '';\r\n  usernameDisplay = '';\r\n  bodyUpdate = '';\r\n\r\n  /*argumenos de recuperacion */\r\n  args;\r\n  userNameStorage;\r\n  user;\r\n  contact;\r\n  responseAcceptArray : any = [];\r\n  bodyContact = {\r\n    siduser : '',\r\n    sidcontact : ''\r\n  }\r\n  \r\n  delete = {\r\n    idContact : ''\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.qrScanner.hide();\r\n    this.qrScanner.destroy();\r\n\r\n    this.args = this.storage.get('username').then((result) => {\r\n      this.userNameStorage = result; // <- get username localStorage\r\n\r\n      this.userService.getSekretId(this.userNameStorage).subscribe(response => {\r\n        this.sidArg = response.user[0].sekretid;      // <- get sekret id DB   \r\n        this.getRequests(this.sidArg);\r\n        setInterval(() => {\r\n          this.getRequests(this.sidArg);\r\n        }, 4000);\r\n\r\n        /*  this.ContactsService.GetRequestsUsers(this.sidArg).subscribe(\r\n              response =>{     \r\n                this.requests.push(...response.contacts); // <- get request users\r\n                console.log('requests', this.requests);\r\n                this.user = this.requests.sidcontact;\r\n                this.contact = this.requests.siduser;\r\n                this.numberRequests = response.conteo;\r\n              });          */\r\n      });\r\n\r\n\r\n    })\r\n  }// end ngOnInit\r\n\r\n  getUsername(sekid){\r\n    console.log('sid para obtenter nombre', sekid);\r\n    this.prueba = this.prueba+1;\r\n    console.log('variable deprube', this.prueba);\r\n    /*this.UsersService.getUserNameBySekretId(sekid).subscribe(\r\n      data =>{\r\n        this.usernameDisplay = data.username;\r\n       // console.log(this.usernameDisplay);\r\n      });*/\r\n  }\r\n\r\n  getRequests(prub) {\r\n    this.ContactsService.GetRequestsUsers(prub).subscribe(response => {\r\n      this.requests = response.contacts;\r\n\r\n      this.user = this.requests.sidcontact;\r\n      this.contact = this.requests.siduser;\r\n      this.numberRequests = response.conteo;\r\n    })\r\n  }\r\n\r\n  acceptRequest(id){  \r\n    console.log('[INFO] ID QUE INGRESA', id);\r\n\r\n    this.ContactsService.AcceptRequestUser(id,this.bodyUpdate ).subscribe(\r\n      resp=>{\r\n        this.responseAcceptArray = resp;\r\n        this.user = this.responseAcceptArray.contact.sidcontact;\r\n        this.contact = this.responseAcceptArray.contact.siduser;\r\n        console.log('[INFO CONTACTO] CONTACTO QUE ESTOY ACEPTANDO', this.contact);\r\n\r\n\r\n\r\n\r\n\r\n        this.bodyContact = {\r\n          siduser : this.user,\r\n          sidcontact : this.contact\r\n        }\r\n        this.ContactsService.agreeUser(this.bodyContact);\r\n        if (resp.ok == true) {\r\n          this.uiService.infoAlert('Contacto agregado');\r\n\r\n          this.userService.getNotificationIdBySid(this.contact).subscribe(rs => {\r\n            console.log('[==============]', rs.notId );\r\n            this.pushService.sendPushAcceptRequest(rs.notId).subscribe(ol =>{\r\n              console.log('Send Notification');\r\n            } )\r\n          })\r\n\r\n\r\n     //    this.ngOnInit();\r\n        }\r\n      }\r\n      \r\n    )\r\n    \r\n  }\r\n\r\n  rejectionRequest(idTransaction){\r\n    \r\n    console.log('%%%%%%%%%%%%%%',idTransaction)\r\n    this.ContactsService.rejectedRequest(idTransaction).subscribe(\r\n      resp=>{\r\n        console.log('Respuesta del servicio', resp);\r\n      });\r\n  }\r\n\r\n}\r\n"],"sourceRoot":"webpack:///","file":"pages-requests-requests-module-es5.js"}