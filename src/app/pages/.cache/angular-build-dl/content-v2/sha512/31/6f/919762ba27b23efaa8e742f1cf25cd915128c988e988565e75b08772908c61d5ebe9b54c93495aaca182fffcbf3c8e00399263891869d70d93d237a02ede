{"version":3,"sources":["./src/app/pages/admingroups/admingroups.page.html","./src/app/pages/admingroups/admingroups.module.ts","./src/app/pages/admingroups/admingroups.page.scss","./src/app/pages/admingroups/admingroups.page.ts"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAe,wiBAAye,2CAA2C,eAAe,2zB;;;;;;;;;;;;;;;;;;;;;;ACAzgB;AACM;AACF;AACU;AAEV;AAEQ;AAErD,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,iEAAe;KAC3B;CACF,CAAC;AAWF,IAAa,qBAAqB,GAAlC,MAAa,qBAAqB;CAAG;AAAxB,qBAAqB;IATjC,8DAAQ,CAAC;QACR,OAAO,EAAE;YACP,4DAAY;YACZ,0DAAW;YACX,0DAAW;YACX,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;SAC9B;QACD,YAAY,EAAE,CAAC,iEAAe,CAAC;KAChC,CAAC;GACW,qBAAqB,CAAG;AAAH;;;;;;;;;;;;;ACzBlC;AAAe,uEAAQ,gBAAgB,GAAG,aAAa,eAAe,GAAG,6CAA6C,uqB;;;;;;;;;;;;;;;;;;;;;;ACApE;AAC6B;AAC9B;AAEoB;AACT;AACnB;AAOzC,IAAa,eAAe,GAA5B,MAAa,eAAe;IA0B1B,YACU,cAA8B,EAC9B,YAA+B,EAC/B,WAAyB,EAC1B,eAAgC,EAC/B,MAAc,EACd,OAAgB;QALhB,mBAAc,GAAd,cAAc,CAAgB;QAC9B,iBAAY,GAAZ,YAAY,CAAmB;QAC/B,gBAAW,GAAX,WAAW,CAAc;QAC1B,oBAAe,GAAf,eAAe,CAAiB;QAC/B,WAAM,GAAN,MAAM,CAAQ;QACd,YAAO,GAAP,OAAO,CAAS;QA/B1B,YAAO,GAAG,EAAE,CAAC;QAIb,YAAO,GAAG,EAAE,CAAC;QAEb,iBAAY,GAAG;YACb,OAAO,EAAG,EAAE;YACZ,MAAM,EAAG,EAAE;YACX,MAAM,EAAG,EAAE;SACd;QAED,kBAAa,GAAG;YACd,OAAO,EAAG,EAAE;YACZ,OAAO,EAAG,EAAE;SACb;QAED,qBAAgB,GAAE;YACjB,MAAM,EAAE,EAAE;YACV,KAAK,EAAE,EAAE;SACT;QAED,iBAAY,GAAG,EAAE,CAAC;IAUZ,CAAC;IAEL,QAAQ;QACN,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QACpE,OAAO,CAAC,GAAG,CAAC,8DAA8D,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QAC1F,OAAO,CAAC,GAAG,CAAC,mFAAmF,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QAE/G,IAAI,CAAC,eAAe,EAAE,CAAC;QAEvB,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,EAAE;YAC3C,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,SAAS,CAAC,YAAY,CAAC,EAAE;gBAC5D,IAAI,CAAC,WAAW,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;gBAC5C,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YAChD,CAAC,CAAC;QACJ,CAAC,CAAC;IAMJ,CAAC;IAED,QAAQ,CAAC,GAAG,EAAE,WAAW;QACvB,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,EAAE;YAE1D,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC;YAC1D,OAAO,CAAC,GAAG,CAAC,cAAc,EAAC,IAAI,CAAC,YAAY,CAAE,CAAC;YAC/C,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YAC7C,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;gBAC3B,IAAI,IAAI,CAAC,OAAO,KAAK,GAAG,EAAG;oBACzB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC;oBAC7B,OAAO,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,KAAK,CAAE;oBAC/C;;uBAEG;iBACJ;YACH,CAAC,CAAC;QACJ,CAAC,CAAC;IACJ,CAAC;IAID,eAAe;QACb,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,iBAAiB,CAAC,EAAE;YAEzE,IAAI,CAAC,OAAO,GAAG,iBAAiB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YACzC,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC;YACxD,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;gBACrC,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,SAAS,CAAC,gBAAgB,CAAC,EAAE;oBAC7E,IAAI,CAAC,MAAM,GAAI,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;oBACxC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC;oBACrC,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;oBAE3C,IAAI,IAAI,CAAC,OAAO,KAAK,GAAG,EAAE;wBACxB,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC;qBAC9B;oBACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;wBAChB,OAAO,EAAG,IAAI,CAAC,OAAO;wBACtB,QAAQ,EAAG,IAAI,CAAC,UAAU;wBAC1B,IAAI,EAAG,IAAI,CAAC,QAAQ;wBACpB,EAAE,EAAE,IAAI,CAAC,GAAG;qBACb,CAAC;gBACJ,CAAC,CAAC,CAAC;YACL,CAAC,CAAC;YACF,OAAO,CAAC,GAAG,CAAC,yBAAyB,EAAE,IAAI,CAAC,OAAO,CAAE,CAAC;QAExD,CAAC,CAAC;IACJ,CAAC;IAED,UAAU,CAAC,OAAO;QAChB,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,OAAO,CAAC;QAC3B,OAAO,CAAC,GAAG,CAAC,IAAI,GAAE;YAChB,OAAO,CAAC,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;QACjC,CAAC,CAAC;IACJ,CAAC;IAED,eAAe,CAAC,QAAQ,EAAE,GAAG;QAC3B,IAAI,CAAC,YAAY,GAAG;YACd,OAAO,EAAG,IAAI,CAAC,OAAO;YACtB,MAAM,EAAG,QAAQ;YACjB,MAAM,EAAG,GAAG;SACjB;QACD,IAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,EAAE;YAClF,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;YAC5B,IAAI,cAAc,CAAC,EAAE,KAAK,IAAI,EAAI;gBAChC,IAAI,CAAC,gBAAgB,GAAG;oBACtB,MAAM,EAAE,GAAG;oBACZ,KAAK,EAAE,IAAI,CAAC,OAAO;iBACnB;gBACD,OAAO,CAAC,GAAG,CAAC,0CAA0C,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;gBAChF,IAAI,CAAC,YAAY,CAAC,iBAAiB,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,SAAS,CAAC,kBAAkB,CAAC,EAAE;oBACxF,OAAO,CAAC,GAAG,CAAC,0BAA0B,EAAC,kBAAkB,CAAC,CAAC;oBAC3D,OAAO,CAAC,GAAG,CAAC,kCAAkC,EAAC,IAAI,CAAC,OAAO,CAAC,CAAC;oBAG7D,IAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,SAAS,CAAC,cAAc,CAAC,EAAE;wBACvF,OAAO,CAAC,GAAG,CAAC,iCAAiC,EAAC,cAAc,CAAE,CAAC;wBAC/D,IAAI,cAAc,CAAC,EAAE,KAAK,IAAI,EAAG;4BAC/B,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;yBACnC;oBACF,CAAC,CAAC;gBACJ,CAAC,CAAC;aACF;QACH,CAAC,CAAC;IACJ,CAAC;IAED,WAAW,CAAC,OAAO;QACjB,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QACrB,OAAO,CAAC,GAAG,CAAC,gCAAgC,EAAE,IAAI,CAAC,OAAO,CAAE,CAAC;QAC7D,IAAI,CAAC,aAAa,GAAG;YACnB,OAAO,EAAG,OAAO;YACjB,OAAO,EAAG,IAAI,CAAC,OAAO;SACvB;QACD,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,SAAS,CAAC,eAAe,CAAC,EAAE;YAC5E,OAAO,CAAC,GAAG,CAAC,mCAAmC,EAAE,eAAe,CAAC,CAAC;YAClE,IAAI,eAAe,CAAC,EAAE,KAAK,IAAI,EAAG;gBAChC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;aACnC;QACH,CAAC,CAAC;IACJ,CAAC;IAGK,mBAAmB,CAAC,OAAO;;YAC/B,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,MAAM,EAAE,WAAW;gBACnB,OAAO,EAAE,2DAA2D;gBACpE,OAAO,EAAE;oBACP;wBACE,IAAI,EAAE,UAAU;wBAChB,IAAI,EAAE,QAAQ;wBACd,QAAQ,EAAE,WAAW;wBACrB,OAAO,EAAE,CAAC,IAAI,EAAE,EAAE;4BAChB,OAAO,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;wBACtC,CAAC;qBACF,EAAE;wBACD,IAAI,EAAE,IAAI;wBACV,OAAO,EAAE,GAAG,EAAE;4BACZ,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;4BAC5B,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;wBAC5B,CAAC;qBACF;iBACF;aACF,CAAC,CAAC;YACH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC;QACxB,CAAC;KAAA;CAGF;;YAzJ2B,8DAAc;YACf,6EAAgB;YAClB,oEAAY;YACT,8DAAe;YACvB,sDAAM;YACL,sDAAO;;AAhCf,eAAe;IAL3B,+DAAS,CAAC;QACT,QAAQ,EAAE,iBAAiB;QAC3B,iOAAsC;;KAEvC,CAAC;2EA4B0B,8DAAc;QACf,6EAAgB;QAClB,oEAAY;QACT,8DAAe;QACvB,sDAAM;QACL,sDAAO;GAhCf,eAAe,CAoL3B;AApL2B","file":"pages-admingroups-admingroups-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar color=\\\"warning\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button defaultHref=\\\"/groups\\\" icon-only></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>Administrar</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n\\n  <ion-card>\\n    <ion-card-header>\\n      <ion-card-subtitle>Participantes</ion-card-subtitle>\\n    </ion-card-header>\\n  \\n    <ion-card-content>\\n      <ion-list>\\n        <ion-item *ngFor=\\\"let member of members; let i = index\\\">\\n          <ion-label> {{ member.name }} </ion-label>\\n          <ion-icon name=\\\"star\\\" slot=\\\"start\\\" *ngIf=\\\"member.isadmin === '1'\\\" class=\\\"star\\\"></ion-icon>\\n          <ion-icon name=\\\"person-remove\\\" \\n                    slot=\\\"end\\\" \\n                    *ngIf=\\\"member.isadmin !== '1'\\\" \\n                    class=\\\"remove\\\"\\n                    (click)=\\\"removeFromGroup(member.id, member.idMember)\\\"></ion-icon>\\n        </ion-item>\\n      </ion-list>\\n    </ion-card-content>\\n  </ion-card>\\n\\n  <ion-card  *ngIf=\\\"admin === currentUser\\\">\\n  <ion-card-header>\\n      <ion-card-subtitle>Administración</ion-card-subtitle>\\n    </ion-card-header>\\n    <ion-card-content>\\n      <ion-button expand=\\\"block\\\" color=\\\"danger\\\" (click)=\\\"presentAlertConfirm(groupId)\\\">Eliminar Grupo</ion-button>\\n    </ion-card-content>\\n  </ion-card>\\n\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { AdmingroupsPage } from './admingroups.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: AdmingroupsPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [AdmingroupsPage]\n})\nexport class AdmingroupsPageModule {}\n","export default \".star {\\n  color: gold;\\n}\\n\\n.remove {\\n  color: red;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvYWRtaW5ncm91cHMvQzpcXFVzZXJzXFxOZW1lc3Npc1xcRGVza3RvcFxccHJvamVjdHNcXGp1bmlvXFxjYWxsc1xcY3BcXGZzdSAtIENvcHkvc3JjXFxhcHBcXHBhZ2VzXFxhZG1pbmdyb3Vwc1xcYWRtaW5ncm91cHMucGFnZS5zY3NzIiwic3JjL2FwcC9wYWdlcy9hZG1pbmdyb3Vwcy9hZG1pbmdyb3Vwcy5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxXQUFBO0FDQ0o7O0FERUE7RUFDSSxVQUFBO0FDQ0oiLCJmaWxlIjoic3JjL2FwcC9wYWdlcy9hZG1pbmdyb3Vwcy9hZG1pbmdyb3Vwcy5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuc3RhcntcclxuICAgIGNvbG9yOiBnb2xkO1xyXG59XHJcblxyXG4ucmVtb3Zle1xyXG4gICAgY29sb3I6IHJlZDtcclxufSIsIi5zdGFyIHtcbiAgY29sb3I6IGdvbGQ7XG59XG5cbi5yZW1vdmUge1xuICBjb2xvcjogcmVkO1xufSJdfQ== */\"","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, ChildActivationStart, Router } from '@angular/router';\nimport { AlertController } from '@ionic/angular';\n\nimport { ChatGroupService } from '../../services/chat-group.service';\nimport { UsersService } from '../../services/users.service';\nimport { Storage } from '@ionic/storage';\n\n@Component({\n  selector: 'app-admingroups',\n  templateUrl: './admingroups.page.html',\n  styleUrls: ['./admingroups.page.scss'],\n})\nexport class AdmingroupsPage implements OnInit {\n  groupId = '';\n  rsGroup;\n  rsUser;\n  userName;\n  members = [];\n  membersWithoutUsername;\n  arrDelMember = {\n    groupId : \"\",\n    userId : \"\",\n    idUser : \"\"\n}\n\ntoDeleteGroup = {\n  idgroup : '',\n  members : []\n}\n\narrDelGroupUserC= {\n\tidUser: \"\", \n\tmsgId: \"\"\n}\nadmin;\ngInfoMembers = [];\ncurrentUser;\n\n  constructor(\n    private activatedRoute: ActivatedRoute,\n    private groupService:  ChatGroupService,\n    private userService: UsersService,\n    public alertController: AlertController,\n    private router: Router,\n    private storage: Storage,\n  ) { }\n\n  ngOnInit() {\n    this.groupId = this.activatedRoute.snapshot.paramMap.get('idgroup');\n    console.log('============================ID GROUP========================', this.groupId);\n    console.log('=================================================================================', this.groupId);\n\n    this.getParticipants();\n    \n    this.storage.get('username').then((result) => {\n      this.userService.getSekretId(result).subscribe(responseUser => {\n        this.currentUser = responseUser.user[0]._id;\n        this.getInfoG(this.groupId, this.currentUser);\n      })\n    })\n\n\n\n\n   \n  }\n\n  getInfoG(gid, currentUser){\n    this.groupService.getInfoGroup(gid).subscribe(rsInfoGroup => {\n      \n      this.gInfoMembers = rsInfoGroup.chatGroup[0].participants;\n      console.log('XX XX XX XX ',this.gInfoMembers );\n      console.log('$$ $$ $$ $$', this.currentUser);\n      this.gInfoMembers.map(elem => {\n        if (elem.isadmin === '1' ) {\n          this.admin = elem.receiverId;\n          console.log('### ### ### ### ###', this.admin )\n          /* if (elem.receiverId === currentUser ) {\n            this.admin =  elemn;  \n          }*/\n        }\n      })\n    })\n  }\n\n\n\n  getParticipants(){\n    this.groupService.getGroupInfo(this.groupId).subscribe(responseGroupInfo => {\n      \n      this.rsGroup = responseGroupInfo.data[0];\n      this.membersWithoutUsername = this.rsGroup.participants;\n      this.membersWithoutUsername.map(elem => {\n        this.userService.getusernameById(elem.receiverId).subscribe(responseNameUser => {\n          this.rsUser =  responseNameUser.user[0];\n          this.userName = this.rsUser.username;\n          console.log('USERNAME => ', this.userName);\n          \n          if (elem.isadmin === \"0\") {\n            console.log('ADMIN DETECTED')\n          }\n          this.members.push({\n            isadmin : elem.isadmin,\n            idMember : elem.receiverId,\n            name : this.userName,\n            id: elem._id\n          })\n        });\n      })\n      console.log('Pariticpantes del grupo', this.members );\n     \n    })\n  }\n\n  Admingroup(members){\n    console.log('$%&', members)\n    members.map(elem=>{\n      console.log('ELEMENTO ', elem);\n    })\n  }\n\n  removeFromGroup(idMember, idu){\n    this.arrDelMember = {\n          groupId : this.groupId,\n          userId : idMember,\n          idUser : idu\n    }\n    this.groupService.deleteMemberOfGroup(this.arrDelMember).subscribe(responseDelMem => {\n      console.log(responseDelMem);\n      if (responseDelMem.ok === true )  {\n        this.arrDelGroupUserC = {\n          idUser: idu, \n\t        msgId: this.groupId\n        }\n        console.log('ARREGLO DEL USUARIO QUE SE VA A ELIMINAR', this.arrDelGroupUserC);\n       this.groupService.deleteGroupOfUser(this.arrDelGroupUserC).subscribe(responseDelUsGroup => {\n         console.log('++--++--++--++--++--++--',responseDelUsGroup);\n         console.log('++--++--++--GROUP ID++--++--++--',this.groupId);\n         \n\n         this.groupService.deleteGroupFromUser(this.arrDelGroupUserC).subscribe(rsDeleteGroupU =>{\n          console.log('#$#$#$#$#$# #$#$#$#$%# #$#$#$#$',rsDeleteGroupU );\n          if (rsDeleteGroupU.ok === true ) {\n            this.router.navigate(['/groups']);\n          }\n         })\n       })\n      }\n    })\n  }\n\n  deleteGroup(groupId) {\n    console.log(groupId);\n    console.log('+ + + Miembros del grupo + + +', this.members );\n    this.toDeleteGroup = {\n      idgroup : groupId,\n      members : this.members\n    }\n    this.groupService.deleteGroup(this.toDeleteGroup).subscribe(responseDeleteG => {\n      console.log('======> Response DELETE GROUP => ', responseDeleteG);\n      if (responseDeleteG.ok === true ) {\n        this.router.navigate(['/groups']);\n      }\n    })\n  }\n\n \n  async presentAlertConfirm(idGroup) {\n    const alert = await this.alertController.create({\n      header: 'Atención!',\n      message: 'Esta <strong>Seguro </strong>que desea eliminar el Grupo?',\n      buttons: [\n        {\n          text: 'Cancelar',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: (blah) => {\n            console.log('Confirm Cancel: blah');\n          }\n        }, {\n          text: 'Si',\n          handler: () => {\n            console.log('Confirm Okay');\n            this.deleteGroup(idGroup);\n          }\n        }\n      ]\n    });\n    await alert.present();\n  }\n\n\n}\n"],"sourceRoot":"webpack:///"}