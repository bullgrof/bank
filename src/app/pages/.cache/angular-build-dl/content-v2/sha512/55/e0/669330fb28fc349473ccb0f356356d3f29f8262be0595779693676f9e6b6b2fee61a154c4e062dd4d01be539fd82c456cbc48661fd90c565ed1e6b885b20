{"version":3,"sources":["src/app/pages/admingroups/admingroups.page.html","src/app/pages/admingroups/admingroups.module.ts","src/app/pages/admingroups/admingroups.page.scss","src/app/pages/admingroups/admingroups.page.ts"],"names":[],"mappings":"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","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>Administrar</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n\\n  <ion-card>\\n    <ion-card-header>\\n      <ion-card-subtitle>Participantes</ion-card-subtitle>\\n    </ion-card-header>\\n  \\n    <ion-card-content>\\n      <ion-list>\\n        <ion-item *ngFor=\\\"let member of members; let i = index\\\">\\n          <ion-label> {{ member.name }} </ion-label>\\n          <ion-icon name=\\\"star\\\" slot=\\\"start\\\" *ngIf=\\\"member.isadmin === '1'\\\" class=\\\"star\\\"></ion-icon>\\n          <ion-icon name=\\\"person-remove\\\" \\n                    slot=\\\"end\\\" \\n                    *ngIf=\\\"member.isadmin !== '1'\\\" \\n                    class=\\\"remove\\\"\\n                    (click)=\\\"removeFromGroup(member.id, member.idMember)\\\"></ion-icon>\\n        </ion-item>\\n      </ion-list>\\n    </ion-card-content>\\n  </ion-card>\\n\\n  <ion-card  *ngIf=\\\"admin === currentUser\\\">\\n  <ion-card-header>\\n      <ion-card-subtitle>Administración</ion-card-subtitle>\\n    </ion-card-header>\\n    <ion-card-content>\\n      <ion-button expand=\\\"block\\\" color=\\\"danger\\\" (click)=\\\"presentAlertConfirm(groupId)\\\">Eliminar Grupo</ion-button>\\n    </ion-card-content>\\n  </ion-card>\\n\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { AdmingroupsPage } from './admingroups.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: AdmingroupsPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [AdmingroupsPage]\n})\nexport class AdmingroupsPageModule {}\n","export default \".star {\\n  color: gold;\\n}\\n\\n.remove {\\n  color: red;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvYWRtaW5ncm91cHMvQzpcXFVzZXJzXFxOZW1lc3Npc1xcRGVza3RvcFxccHJvamVjdHNcXGp1bmlvXFxmc3UgLSBDb3B5L3NyY1xcYXBwXFxwYWdlc1xcYWRtaW5ncm91cHNcXGFkbWluZ3JvdXBzLnBhZ2Uuc2NzcyIsInNyYy9hcHAvcGFnZXMvYWRtaW5ncm91cHMvYWRtaW5ncm91cHMucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksV0FBQTtBQ0NKOztBREVBO0VBQ0ksVUFBQTtBQ0NKIiwiZmlsZSI6InNyYy9hcHAvcGFnZXMvYWRtaW5ncm91cHMvYWRtaW5ncm91cHMucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnN0YXJ7XHJcbiAgICBjb2xvcjogZ29sZDtcclxufVxyXG5cclxuLnJlbW92ZXtcclxuICAgIGNvbG9yOiByZWQ7XHJcbn0iLCIuc3RhciB7XG4gIGNvbG9yOiBnb2xkO1xufVxuXG4ucmVtb3ZlIHtcbiAgY29sb3I6IHJlZDtcbn0iXX0= */\"","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, ChildActivationStart, Router } from '@angular/router';\nimport { AlertController } from '@ionic/angular';\n\nimport { ChatGroupService } from '../../services/chat-group.service';\nimport { UsersService } from '../../services/users.service';\nimport { Storage } from '@ionic/storage';\n\n@Component({\n  selector: 'app-admingroups',\n  templateUrl: './admingroups.page.html',\n  styleUrls: ['./admingroups.page.scss'],\n})\nexport class AdmingroupsPage implements OnInit {\n  groupId = '';\n  rsGroup;\n  rsUser;\n  userName;\n  members = [];\n  membersWithoutUsername;\n  arrDelMember = {\n    groupId : \"\",\n    userId : \"\",\n    idUser : \"\"\n}\n\ntoDeleteGroup = {\n  idgroup : '',\n  members : []\n}\n\narrDelGroupUserC= {\n\tidUser: \"\", \n\tmsgId: \"\"\n}\nadmin;\ngInfoMembers = [];\ncurrentUser;\n\n  constructor(\n    private activatedRoute: ActivatedRoute,\n    private groupService:  ChatGroupService,\n    private userService: UsersService,\n    public alertController: AlertController,\n    private router: Router,\n    private storage: Storage,\n  ) { }\n\n  ngOnInit() {\n    this.groupId = this.activatedRoute.snapshot.paramMap.get('idgroup');\n    console.log('============================ID GROUP========================', this.groupId);\n    console.log('=================================================================================', this.groupId);\n\n    this.getParticipants();\n    \n    this.storage.get('username').then((result) => {\n      this.userService.getSekretId(result).subscribe(responseUser => {\n        this.currentUser = responseUser.user[0]._id;\n        this.getInfoG(this.groupId, this.currentUser);\n      })\n    })\n\n\n\n\n   \n  }\n\n  getInfoG(gid, currentUser){\n    this.groupService.getInfoGroup(gid).subscribe(rsInfoGroup => {\n      \n      this.gInfoMembers = rsInfoGroup.chatGroup[0].participants;\n      console.log('XX XX XX XX ',this.gInfoMembers );\n      console.log('$$ $$ $$ $$', this.currentUser);\n      this.gInfoMembers.map(elem => {\n        if (elem.isadmin === '1' ) {\n          this.admin = elem.receiverId;\n          console.log('### ### ### ### ###', this.admin )\n          /* if (elem.receiverId === currentUser ) {\n            this.admin =  elemn;  \n          }*/\n        }\n      })\n    })\n  }\n\n\n\n  getParticipants(){\n    this.groupService.getGroupInfo(this.groupId).subscribe(responseGroupInfo => {\n      \n      this.rsGroup = responseGroupInfo.data[0];\n      this.membersWithoutUsername = this.rsGroup.participants;\n      this.membersWithoutUsername.map(elem => {\n        this.userService.getusernameById(elem.receiverId).subscribe(responseNameUser => {\n          this.rsUser =  responseNameUser.user[0];\n          this.userName = this.rsUser.username;\n          console.log('USERNAME => ', this.userName);\n          \n          if (elem.isadmin === \"0\") {\n            console.log('ADMIN DETECTED')\n          }\n          this.members.push({\n            isadmin : elem.isadmin,\n            idMember : elem.receiverId,\n            name : this.userName,\n            id: elem._id\n          })\n        });\n      })\n      console.log('Pariticpantes del grupo', this.members );\n     \n    })\n  }\n\n  Admingroup(members){\n    console.log('$%&', members)\n    members.map(elem=>{\n      console.log('ELEMENTO ', elem);\n    })\n  }\n\n  removeFromGroup(idMember, idu){\n    this.arrDelMember = {\n          groupId : this.groupId,\n          userId : idMember,\n          idUser : idu\n    }\n    this.groupService.deleteMemberOfGroup(this.arrDelMember).subscribe(responseDelMem => {\n      console.log(responseDelMem);\n      if (responseDelMem.ok === true )  {\n        this.arrDelGroupUserC = {\n          idUser: idu, \n\t        msgId: this.groupId\n        }\n        console.log('ARREGLO DEL USUARIO QUE SE VA A ELIMINAR', this.arrDelGroupUserC);\n       this.groupService.deleteGroupOfUser(this.arrDelGroupUserC).subscribe(responseDelUsGroup => {\n         console.log(responseDelUsGroup);\n       })\n      }\n    })\n  }\n\n  deleteGroup(groupId) {\n    console.log(groupId);\n    console.log('+ + + Miembros del grupo + + +', this.members );\n    this.toDeleteGroup = {\n      idgroup : groupId,\n      members : this.members\n    }\n    this.groupService.deleteGroup(this.toDeleteGroup).subscribe(responseDeleteG => {\n      console.log('======> Response DELETE GROUP => ', responseDeleteG);\n      if (responseDeleteG.ok === true ) {\n        this.router.navigate(['/groups']);\n      }\n    })\n  }\n\n \n  async presentAlertConfirm(idGroup) {\n    const alert = await this.alertController.create({\n      header: 'Atención!',\n      message: 'Esta <strong>Seguro </strong>que desea eliminar el Grupo?',\n      buttons: [\n        {\n          text: 'Cancelar',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: (blah) => {\n            console.log('Confirm Cancel: blah');\n          }\n        }, {\n          text: 'Si',\n          handler: () => {\n            console.log('Confirm Okay');\n            this.deleteGroup(idGroup);\n          }\n        }\n      ]\n    });\n    await alert.present();\n  }\n\n\n}\n"],"sourceRoot":"webpack:///","file":"pages-admingroups-admingroups-module-es5.js"}