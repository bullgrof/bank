{"version":3,"sources":["./src/app/pages/requests/requests.page.html","./src/app/pages/requests/requests.module.ts","./src/app/pages/requests/requests.page.scss","./src/app/pages/requests/requests.page.ts"],"names":[],"mappings":"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","file":"pages-requests-requests-module-es2015.js","sourcesContent":["export default \"<ion-header >\\r\\n  <ion-toolbar color=\\\"warning\\\">\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-back-button defaultHref=\\\"/contacts\\\" text=\\\"\\\"></ion-back-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title>{{'REQUESTS.title' | translate}} ({{numberRequests}})</ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <ion-list>\\r\\n    <h3 *ngIf=\\\"requests.length === 0 \\\" class=\\\"text-center\\\">{{'REQUESTS.dontHaveRequests' | translate}}</h3>\\r\\n    <ion-item-sliding *ngFor=\\\"let req of requests\\\">\\r\\n      <ion-item class=\\\"itemheight\\\" *ngIf=\\\"requests.length > 0 \\\">\\r\\n        <ion-avatar slot=\\\"start\\\">\\r\\n          <img src=\\\"../../../assets/avatars/defaultavatar.png\\\">\\r\\n        </ion-avatar>\\r\\n        <ion-label class=\\\"sc-ion-label-ios-h sc-ion-label-ios-s ios hydrated\\\">\\r\\n          <h3>{{ req.siduser }}</h3>\\r\\n        </ion-label>\\r\\n        <p><small>{{req.message}}</small> </p>\\r\\n        <ion-icon slot=\\\"end\\\" name=\\\"chevron-back-outline\\\" class=\\\"backArrow\\\"></ion-icon>\\r\\n        <label slot=\\\"end\\\" class=\\\"swip\\\">{{'REQUESTS.swip' | translate}} </label>\\r\\n      </ion-item>\\r\\n      <ion-item-options side=\\\"end\\\">\\r\\n        <ion-item-option (click)=\\\"acceptRequest(req._id)\\\" color=\\\"success\\\">\\r\\n          <ion-icon name=\\\"checkmark-circle\\\"></ion-icon>{{'REQUESTS.acept' | translate}}\\r\\n        </ion-item-option>\\r\\n        <ion-item-option (click)=\\\"rejectionRequest(req._id)\\\" color=\\\"danger\\\">\\r\\n          <ion-icon name=\\\"trash\\\"></ion-icon>{{'REQUESTS.reject' | translate}}\\r\\n        </ion-item-option>\\r\\n      </ion-item-options>\\r\\n    </ion-item-sliding>\\r\\n  </ion-list>\\r\\n</ion-content>\"","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { RequestsPage } from './requests.page';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: RequestsPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    RouterModule.forChild(routes),\r\n    TranslateModule\r\n  ],\r\n  declarations: [RequestsPage]\r\n})\r\nexport class RequestsPageModule {}\r\n","export default \".text-center {\\n  text-align: center;\\n  margin-top: 50%;\\n}\\n\\n.swip {\\n  color: #424242;\\n  font-size: 12px;\\n}\\n\\n.backArrow {\\n  color: #424242;\\n}\\n\\n.nameUser {\\n  font-weight: bold;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvcmVxdWVzdHMvQzpcXFVzZXJzXFxOZW1lc3Npc1xcRGVza3RvcFxcZnN1IC0gQ29weS9zcmNcXGFwcFxccGFnZXNcXHJlcXVlc3RzXFxyZXF1ZXN0cy5wYWdlLnNjc3MiLCJzcmMvYXBwL3BhZ2VzL3JlcXVlc3RzL3JlcXVlc3RzLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGtCQUFBO0VBQ0EsZUFBQTtBQ0NKOztBREVBO0VBQ0ksY0FBQTtFQUNBLGVBQUE7QUNDSjs7QURFQTtFQUNJLGNBQUE7QUNDSjs7QURFQTtFQUNJLGlCQUFBO0FDQ0oiLCJmaWxlIjoic3JjL2FwcC9wYWdlcy9yZXF1ZXN0cy9yZXF1ZXN0cy5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIudGV4dC1jZW50ZXJ7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICBtYXJnaW4tdG9wOiA1MCU7XHJcbn1cclxuXHJcbi5zd2lwe1xyXG4gICAgY29sb3IgOiM0MjQyNDI7XHJcbiAgICBmb250LXNpemU6IDEycHg7XHJcbn1cclxuXHJcbi5iYWNrQXJyb3d7XHJcbiAgICBjb2xvcjogIzQyNDI0MjtcclxufVxyXG5cclxuLm5hbWVVc2Vye1xyXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbn0iLCIudGV4dC1jZW50ZXIge1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gIG1hcmdpbi10b3A6IDUwJTtcbn1cblxuLnN3aXAge1xuICBjb2xvcjogIzQyNDI0MjtcbiAgZm9udC1zaXplOiAxMnB4O1xufVxuXG4uYmFja0Fycm93IHtcbiAgY29sb3I6ICM0MjQyNDI7XG59XG5cbi5uYW1lVXNlciB7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xufSJdfQ== */\"","import { Component, OnInit } from '@angular/core';\r\nimport { ContactsService } from 'src/app/services/contacts.service';\r\nimport { UsersService } from 'src/app/services/users.service';\r\nimport { ThrowStmt } from '@angular/compiler';\r\nimport { ActivatedRoute } from '@angular/router';\r\n\r\nimport { Storage } from '@ionic/storage';\r\nimport { UiServiceService } from 'src/app/services/ui-service.service';\r\nimport { PushService } from 'src/app/services/push.service';\r\n\r\n\r\nimport { QRScanner, QRScannerStatus } from '@ionic-native/qr-scanner/ngx';\r\n\r\n@Component({\r\n  selector: 'app-requests',\r\n  templateUrl: './requests.page.html',\r\n  styleUrls: ['./requests.page.scss'],\r\n})\r\nexport class RequestsPage implements OnInit {\r\n\r\n  constructor(private ContactsService: ContactsService,\r\n              private UsersService: UsersService,\r\n              private activeRoute: ActivatedRoute,\r\n              private storage: Storage,\r\n              private userService: UsersService,\r\n              private uiService: UiServiceService,\r\n              private qrScanner:  QRScanner,\r\n              private pushService : PushService ) { }\r\n\r\n  //vars front\r\n  sidArg = '';\r\n  numberRequests = 0;\r\n  requests : any = [];\r\n  prueba = '';\r\n  usernameDisplay = '';\r\n  bodyUpdate = '';\r\n\r\n  /*argumenos de recuperacion */\r\n  args;\r\n  userNameStorage;\r\n  user;\r\n  contact;\r\n  responseAcceptArray : any = [];\r\n  bodyContact = {\r\n    siduser : '',\r\n    sidcontact : ''\r\n  }\r\n  \r\n  delete = {\r\n    idContact : ''\r\n  }\r\n  notificate = {\r\n    apid: '',\r\n    notid: ''\r\n  }\r\n\r\n  arrUser;\r\n\r\n  ngOnInit() {\r\n    this.qrScanner.hide();\r\n    this.qrScanner.destroy();\r\n\r\n    this.args = this.storage.get('username').then((result) => {\r\n      this.userNameStorage = result; // <- get username localStorage\r\n\r\n      this.userService.getSekretId(this.userNameStorage).subscribe(response => {\r\n        this.sidArg = response.user[0].sekretid;      // <- get sekret id DB   \r\n        this.getRequests(this.sidArg);\r\n        setInterval(() => {\r\n          this.getRequests(this.sidArg);\r\n        }, 4000);\r\n\r\n        /*  this.ContactsService.GetRequestsUsers(this.sidArg).subscribe(\r\n              response =>{     \r\n                this.requests.push(...response.contacts); // <- get request users\r\n                console.log('requests', this.requests);\r\n                this.user = this.requests.sidcontact;\r\n                this.contact = this.requests.siduser;\r\n                this.numberRequests = response.conteo;\r\n              });          */\r\n      });\r\n\r\n\r\n    })\r\n  }// end ngOnInit\r\n\r\n  getUsername(sekid){\r\n    console.log('sid para obtenter nombre', sekid);\r\n    this.prueba = this.prueba+1;\r\n    console.log('variable deprube', this.prueba);\r\n    /*this.UsersService.getUserNameBySekretId(sekid).subscribe(\r\n      data =>{\r\n        this.usernameDisplay = data.username;\r\n       // console.log(this.usernameDisplay);\r\n      });*/\r\n  }\r\n\r\n  getRequests(prub) {\r\n    this.ContactsService.GetRequestsUsers(prub).subscribe(response => {\r\n      this.requests = response.contacts;\r\n\r\n      this.user = this.requests.sidcontact;\r\n      this.contact = this.requests.siduser;\r\n      this.numberRequests = response.conteo;\r\n    })\r\n  }\r\n\r\n  acceptRequest(id){  \r\n    console.log('[INFO] ID QUE INGRESA', id);\r\n    this.ContactsService.AcceptRequestUser(id,this.bodyUpdate )\r\n        .subscribe(resp=>{\r\n                this.responseAcceptArray = resp;\r\n                this.user = this.responseAcceptArray.contact.sidcontact;\r\n                this.contact = this.responseAcceptArray.contact.siduser;\r\n                console.log('[INFO CONTACTO] CONTACTO QUE ESTOY ACEPTANDO', this.contact);\r\n                this.bodyContact = {\r\n                  siduser : this.user,\r\n                  sidcontact : this.contact\r\n                }\r\n                this.ContactsService.agreeUser(this.bodyContact);\r\n                if (resp.ok == true) {\r\n                  this.uiService.infoAlert('Contacto agregado');\r\n                  this.contact;\r\n                  this.userService.getNotificationIdBySid(this.contact).subscribe(rs => {\r\n                    console.log('[==============]', rs.notId );\r\n\r\n                  this.userService.getUserNameBySekretId(this.contact).subscribe(rsContact => {\r\n                    \r\n                    this.arrUser = rsContact.user[0];\r\n                    console.log('RESPUESTA CONTACTOS ++', this.arrUser );\r\n                    this.notificate = {\r\n                      apid: this.arrUser.appidn,\r\n                      notid: this.arrUser.notificationId\r\n                    }\r\n\r\n                    this.pushService.sendPusRequestOk(this.notificate).subscribe(rsPushok => {\r\n                      console.log('&& &&& &&& && ', rsPushok);\r\n                    });\r\n                  })                    \r\n\r\n                 /*  this.pushService.sendPushAcceptRequest(rs.notId).subscribe(ol =>{\r\n                      console.log('Send Notification');\r\n                    } )\r\n                */ \r\n                  })            \r\n                }\r\n        })    \r\n  }\r\n\r\n  rejectionRequest(idTransaction){\r\n    \r\n    console.log('%%%%%%%%%%%%%%',idTransaction)\r\n    this.ContactsService.rejectedRequest(idTransaction).subscribe(\r\n      resp=>{\r\n        console.log('Respuesta del servicio', resp);\r\n      });\r\n  }\r\n\r\n}\r\n"],"sourceRoot":"webpack:///"}