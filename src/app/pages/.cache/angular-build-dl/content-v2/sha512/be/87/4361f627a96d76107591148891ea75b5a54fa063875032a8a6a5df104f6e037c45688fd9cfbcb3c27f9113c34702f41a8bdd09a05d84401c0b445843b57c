{"version":3,"sources":["./src/app/pages/call/call.page.html","./src/app/pages/call/call.module.ts","./src/app/pages/call/call.page.scss","./src/app/pages/call/call.page.ts"],"names":[],"mappings":"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","file":"pages-call-call-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n  <ion-header>\\n    <ion-toolbar>\\n      <ion-buttons slot=\\\"start\\\">\\n        <ion-back-button color=\\\"danger\\\">asd</ion-back-button>\\n      </ion-buttons>\\n    </ion-toolbar>\\n  </ion-header>\\n</ion-header>\\n\\n<ion-content>\\n  <div id=\\\"errorMsg\\\"></div>\\n\\n  <video id=\\\"partner-video\\\" (click)=\\\"swapVideo('my-video')\\\" autoplay playsinline\\n    [ngClass]=\\\"{'top-video': topVideoFrame === 'partner-video', 'main-video': topVideoFrame != 'partner-video'}\\\">\\n  </video>\\n  <video id=\\\"my-video\\\" (click)=\\\"swapVideo('partner-video')\\\" autoplay playsinline\\n    [ngClass]=\\\"{'top-video': topVideoFrame === 'my-video', 'main-video': topVideoFrame != 'my-video'}\\\" >\\n  </video>\\n\\n\\n  <ion-row nowrap>\\n    <ion-button (click)=\\\"inita()\\\">Login As: </ion-button>\\n    <ion-item>\\n      <ion-input type=\\\"text\\\" [(ngModel)]=\\\"userId\\\" placeholder=\\\"enter your nick name\\\"></ion-input>\\n    </ion-item>\\n  </ion-row>\\n\\n  <ion-row nowrap>\\n    <ion-button (click)=\\\"calla()\\\">Call To: </ion-button>\\n    <ion-item>\\n      <ion-input type=\\\"text\\\" [(ngModel)]=\\\"partnerId\\\" placeholder=\\\"your partner nick name\\\"></ion-input>\\n    </ion-item>\\n  </ion-row>  \\n\\n\\n  <ion-fab vertical=\\\"bottom\\\" horizontal=\\\"center\\\" slot=\\\"fixed\\\">\\n    <ion-fab-button color=\\\"danger\\\" (click)=\\\"endCall()\\\">\\n      <ion-icon name=\\\"call\\\" class=\\\"rotate\\\"></ion-icon>\\n    </ion-fab-button>\\n  </ion-fab>\\n\\n\\n  \\n</ion-content>\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { CallPage } from './call.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CallPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [CallPage]\n})\nexport class CallPageModule {}\n","export default \".rotate {\\n  display: inline-block;\\n  transform: rotate(90deg);\\n}\\n\\n.top-video {\\n  position: absolute;\\n  top: 100px;\\n  right: 100px;\\n  max-width: 100px;\\n  z-index: 2;\\n}\\n\\n.main-video {\\n  width: 100%;\\n  max-height: 70%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvY2FsbC9DOlxcVXNlcnNcXE5lbWVzc2lzXFxEZXNrdG9wXFxwcm9qZWN0c1xcanVuaW9cXGNhbGxzXFxmc3UgLSBDb3B5L3NyY1xcYXBwXFxwYWdlc1xcY2FsbFxcY2FsbC5wYWdlLnNjc3MiLCJzcmMvYXBwL3BhZ2VzL2NhbGwvY2FsbC5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxxQkFBQTtFQUNBLHdCQUFBO0FDQ0o7O0FER0E7RUFDSSxrQkFBQTtFQUNBLFVBQUE7RUFDQSxZQUFBO0VBQ0EsZ0JBQUE7RUFDQSxVQUFBO0FDQUo7O0FER0E7RUFDSSxXQUFBO0VBQ0EsZUFBQTtBQ0FKIiwiZmlsZSI6InNyYy9hcHAvcGFnZXMvY2FsbC9jYWxsLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5yb3RhdGV7XHJcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IFxyXG4gICAgdHJhbnNmb3JtOiByb3RhdGUoOTBkZWcpO1xyXG4gICAgXHJcbn1cclxuXHJcbi50b3AtdmlkZW97XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICB0b3A6IDEwMHB4O1xyXG4gICAgcmlnaHQ6IDEwMHB4O1xyXG4gICAgbWF4LXdpZHRoOiAxMDBweDtcclxuICAgIHotaW5kZXg6IDI7XHJcbn1cclxuXHJcbi5tYWluLXZpZGVve1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbiAgICBtYXgtaGVpZ2h0OiA3MCU7XHJcbn0iLCIucm90YXRlIHtcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICB0cmFuc2Zvcm06IHJvdGF0ZSg5MGRlZyk7XG59XG5cbi50b3AtdmlkZW8ge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogMTAwcHg7XG4gIHJpZ2h0OiAxMDBweDtcbiAgbWF4LXdpZHRoOiAxMDBweDtcbiAgei1pbmRleDogMjtcbn1cblxuLm1haW4tdmlkZW8ge1xuICB3aWR0aDogMTAwJTtcbiAgbWF4LWhlaWdodDogNzAlO1xufSJdfQ== */\"","import { Component, OnInit, ElementRef } from '@angular/core';\nimport { WebrtcService } from 'src/app/services/webrtc.service';\nimport { AndroidPermissions } from '@ionic-native/android-permissions/ngx';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { UsersService } from 'src/app/services/users.service';\nimport { Socket } from 'ngx-socket-io';\nimport { PushService } from 'src/app/services/push.service';\nimport { Storage } from '@ionic/storage';\n\n@Component({\n  selector: 'app-call',\n  templateUrl: './call.page.html',\n  styleUrls: ['./call.page.scss'],\n})\nexport class CallPage implements OnInit {\n  topVideoFrame = 'partner-video';\n  userId: string;\n  partnerId: string;\n  myEl: HTMLMediaElement;\n  partnerEl: HTMLMediaElement;\n  partnerIdCall;\n  callerId\n\n  /* VARS USER */\n  arrayContact\n  idContact\n  usernameContact\n  notiIdContact\n  appid;\n  mySid;\n\n  notificate = {\n    apid: '',\n    notid: '',\n    partnerId: '',\n    sid: ''\n  }\n  userStorage\n\n  constructor(\n    public webRTC: WebrtcService,\n    public elRef: ElementRef,\n    private androidPermissions: AndroidPermissions,\n    private activatedRoute: ActivatedRoute,\n    private userService: UsersService,\n    private socket: Socket,\n    private PushService: PushService,\n    private storage: Storage\n  ) { }\n\n\n\n  ngOnInit() {\n    this.androidPermissions\n      .checkPermission(this.androidPermissions.PERMISSION.RECORD_AUDIO)\n      .then(rs => {\n        if (rs.hasPermission === false) {\n          this.androidPermissions.requestPermissions([this.androidPermissions.PERMISSION.RECORD_AUDIO, this.androidPermissions.PERMISSION.GET_ACCOUNTS]);\n        }\n      });\n      this.partnerIdCall = this.makeid(35);\n    //  this.init(this.partnerIdCall)\n\n\n    this.storage.get('username').then((result) => {\n      console.log('++ ++ +++ +++ ++++ +++ ++++ ++++ ++',result);\n      this.userService.getSekretId(result).subscribe(response => {\n        console.log('++ ++ ++ ++ ++ ++', response);\n      this.callerId = this.activatedRoute.snapshot.paramMap.get('caller');\n      this.storage.get('username').then((result) => {\n        this.userService.getSekretId(result).subscribe(response => {\n          this.mySid = response.user[0].sekretid;\n\n      this.userService.getUserNameBySekretId(this.callerId).subscribe(responseContact => {\n        console.log('99999999999999999', responseContact.user );\n        this.arrayContact = responseContact.user[0];\n        console.log('1111 11111 1111 111 1111 11', responseContact);\n       // this.idContact = this.arrayContact._id;\n        this.usernameContact = this.arrayContact.username;\n        this.notiIdContact = this.arrayContact.notificationId;\n        this.appid = this.arrayContact.appidn;\n\n        this.notificate = {\n          apid: this.appid,\n          notid: this.notiIdContact,\n          partnerId: this.mySid,\n          sid: this.mySid\n        }\n        console.log('- - - - - - - - - - - - - - - - - - - - -')\n        this.PushService.sendPushCallOut(this.notificate).subscribe(rsPush=>{\n          console.log('..:::..:::..::..:::',rsPush,':::..:::..:::..::::');\n        })\n      })\n      })\n    })\n    }) // storage\n  }) // getSekretId\n\n      \n  }\n\n  init(userIdCall) {\n    this.myEl = this.elRef.nativeElement.querySelector('#my-video');\n    this.partnerEl = this.elRef.nativeElement.querySelector('#partner-video');\n    this.webRTC.init(userIdCall, this.myEl, this.partnerEl);\n  }\n\n  \n  inita() {\n    console.log('************ USUARIO QUE INICIA ', this.userId);\n    this.myEl = this.elRef.nativeElement.querySelector('#my-video');\n    this.partnerEl = this.elRef.nativeElement.querySelector('#partner-video');\n    this.webRTC.init(this.userId, this.myEl, this.partnerEl);\n  }\n\n  call() {\n    \n    this.webRTC.call(this.partnerId);\n    this.swapVideo('my-video');\n  }\n\n  calla() {\n    console.log('usuario que llama *****',this.partnerId)\n    this.webRTC.call(this.partnerId);\n    this.swapVideo('my-video');\n  }\n\n  swapVideo(topVideo: string) {\n    this.topVideoFrame = topVideo;\n  }\n\n  makeid(length) {\n    let result           = '';\n    let characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    let charactersLength = characters.length;\n    for ( let i = 0; i < length; i++ ) {\n      result += characters.charAt(Math.floor(Math.random() * \n charactersLength));\n   }\n   return result;\n}\n\nendCall(){\n  this.webRTC.hangUp();\n}\n\n}\n"],"sourceRoot":"webpack:///"}